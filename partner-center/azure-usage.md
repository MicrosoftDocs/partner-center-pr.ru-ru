---
title: Размеры виртуальных машин Azure для максимального использования резервирования
description: Узнайте, как масштабировать виртуальную машину с учетом потребностей клиентов при покупке Microsoft Azure резервирования для них.
ms.topic: how-to
ms.service: partner-dashboard
ms.subservice: partnercenter-csp
author: BillLinzbach
ms.author: BillLi
ms.localizationpriority: medium
ms.custom: SEOJULY.20
ms.date: 08/06/2020
ms.openlocfilehash: e6c4e3e7a68de720f586754703308a447d7d30c1
ms.sourcegitcommit: 51e3c912eba8cfa72733206c0fee22386fbc34aa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2020
ms.locfileid: "91000190"
---
# <a name="microsoft-azure-vm-sizing-for-maximum-reservation-usage"></a>Размеры виртуальных машин Microsoft Azure для максимального использования резервирования

**Относится к**

- Центр партнеров
- Портал Azure
- Партнеры в программе CSP
 
> [!NOTE]
> Эта статья относится только к партнерам в программе поставщика облачных решений (CSP). Вместо этого клиенты, использующие другие типы подписок (например, оплата по мере использования, индивидуальные соглашения с клиентами Майкрософт или подписки Соглашение Enterprise), должны читать [эту документацию по резервированию Azure](/azure/cost-management-billing/reservations).

## <a name="determine-the-vm-size-for-a-customers-azure-reservation"></a>Определение размера виртуальной машины для резервирования Azure клиента

При покупке Microsoft Azure резервирования от имени ваших клиентов необходимо выбрать размер виртуальной машины, чтобы удовлетворить потребности клиента. Эту информацию можно получить одним из следующих способов:

- API использования Azure
- Портал Azure
- Azure PowerShell
- API для Azure Resource Manager (ARM)

Ниже приведены инструкции по каждому из этих методов. После приобретения резервирования скидка на резервирование автоматически применяется к виртуальным машинам, которые соответствуют атрибутам и количеству резервирования. Вам не нужно назначать резервирование виртуальной машине.

>[!NOTE]
>Скидки на резервирование не применяются к классическим или рекламным виртуальным машинам.

>[!IMPORTANT]
>Чтобы правильно определить тип и размер виртуальной машины, приобретаемой от лица клиента, воспользуйтесь одним из указанных методов. Помните, что тип серии виртуальной машины неправильно отображается в файлах выверки в Центре партнеров.

### <a name="get-vm-sizing-information-using-the-azure-utilization-api"></a>Получение сведений о размере виртуальной машины с помощью API использования Azure

1. Используйте значение атрибута ServiceType из additionalInfo в ответе API, чтобы определить нужный размер виртуальной машины.

2. Дополнительные сведения см. в статье [получение записей об использовании клиента для Azure](/partner-center/develop/get-a-customer-s-utilization-record-for-azure) в [API центра партнеров](/partner-center/develop/).

### <a name="get-vm-sizing-information-using-the-microsoft-azure-portal"></a>Получение сведений о размере виртуальной машины на портале Microsoft Azure

1. В центре партнеров перейдите на страницу **Клиенты** .

2. Найдите клиента, желающего купить резервирования виртуальных машин Azure, а затем щелкните стрелку вниз, чтобы развернуть сведения о клиенте. Выберите **портал управления Microsoft Azure** , чтобы открыть запись клиента в портал Azure.

3. Выберите пункт **Виртуальные машины** в меню портала, затем выберите виртуальную машину, для которой требуется приобрести резервирование.

4. На странице сведения о виртуальной машине найдите сведения о размере и регионе, как показано ниже, и используйте эти сведения для приобретения резервирования в центре партнеров.  

   :::image type="content" source="images/usage1.png" alt-text="Сведения о размере и регионе на странице сведений":::

### <a name="get-vm-sizing-information-using-microsoft-azure-powershell"></a>Получение сведений о размере виртуальной машины с помощью Microsoft Azure PowerShell

Чтобы определить местоположение и размер виртуальной машины, для которой нужно приобрести резервирование, используйте данные, показанные на рисунке ниже. 

:::image type="content" source="images/usage2.png" alt-text="Расположение и размер виртуальной машины":::

### <a name="get-vm-sizing-information-using-the-azure-resource-manager-arm-api"></a>Получение сведений о размере виртуальной машины с помощью API для Azure Resource Manager (ARM)

1. С помощью ARMClient или API-интерфейсов ARM вызовите клиент ARM для виртуальной машины, для которой требуется приобрести резервирование.

2. /subscriptions/<Subscription ID>/resourceGroups/<Resource group name>/providers/Microsoft.Compute/virtualMachines/<VM Instance Name>?api-version=2017-12-01

3. Вызов возвращает значения для параметров **vmSize** и **location**, как показано ниже.

    :::image type="content" source="images/usage3.png" alt-text="значение vmSize":::
    :::image type="content" source="images/usage4.png" alt-text="значение расположения":::

## <a name="verify-azure-vm-usage-and-reservation-discount"></a>Проверка использования виртуальной машины Azure и скидки на резервирование

После приобретения зарезервированного экземпляра виртуальной машины Azure от имени клиента автоматически применяется скидка за период оплаты для виртуальной машины, которая соответствует атрибутам и количеству резервирования клиента.

Вы можете проверить использование резервирования клиента и узнать, к каким виртуальным машинам применяются скидки на резервирование, одним из следующих способов:

- Портал Azure
- API использования Azure

Ниже приведены инструкции по каждому из этих методов.

>[!NOTE]
>Только API использования Azure показывает, к какой виртуальной машине применяется скидка.  

### <a name="verify-the-customers-reservation-usage-in-the-microsoft-azure-portal"></a>Проверьте использование резервирования клиента в портал Microsoft Azure

1. В центре партнеров перейдите на страницу **Клиенты** .

2. Найдите клиента, для которого требуется проверить скидку резервирования и использование, а затем щелкните стрелку вниз, чтобы развернуть сведения о клиенте. Выберите **портал управления Microsoft Azure** , чтобы открыть запись клиента в портал Azure.
3. Выберите пункт **Резервирования** в меню портала, затем выберите резервирование, чтобы проверить его использование.
4. На странице **Обзор** проверьте график использования резервирования, который показывает, какая часть резервирования была применена к виртуальным машинам.

    >[!NOTE]
    >Данные об использовании могут отображаться с задержкой до 8 часов.

    a. Если использование резервирования составляет 100%, клиент получает все возможные сокращения, которые может предоставить Покупка резервирования.
    b. Если использование резервирования составляет 0%, скидка не применяется ни к одной виртуальной машине.
    c. Если использование резервирования составляет от 1% до 99%, то используются неиспользуемые преимущества.

5. Чтобы избежать такой ситуации, определите требуемый размер виртуальной машины, чтобы обеспечить поддержку вычислительных потребностей клиента перед покупкой.

### <a name="verify-the-customers-reservation-usage-with-the-azure-utilization-api"></a>Проверка использования резервирования клиентом с помощью API использования Azure

>[!NOTE]
>Только API использования Azure показывает, к какой виртуальной машине применяется скидка.  

Вы можете получить данные об использовании резервирования с помощью API использования Azure. Так можно проверить, получает ли клиент скидку за резервирование, и посмотреть, к каким виртуальным машинам применяется эта скидка. Сравните пример а с примером б, чтобы узнать, как проверить использование резервирования клиентом.

:::image type="content" source="images/usage5.png" alt-text="Примеры использования резервирования":::

- Идентификатор reservationId определяет резервирование Azure, которое использовалось для применения скидки к виртуальной машине.
- consumptionMeter — это MeterId для виртуальной машины, к которой применена скидка за резервирование.
- ReservationMeter отображает стоимость $0, так как применена скидка за резервирование.

Дополнительные сведения см. в статье [получение записей об использовании клиента для Azure](/partner-center/develop/get-a-customer-s-utilization-record-for-azure) в [API центра партнеров](/partner-center/develop/).

>[!IMPORTANT]
>Стоимость программного обеспечения, например Microsoft Windows Server, в настоящее время не входит в цену резервирования виртуальных машин и отображается в отдельных строках заказа и счета. Тем не менее, если у клиента есть преимущества гибридного использования Azure, стоимость программного обеспечения не учитывается. Дополнительные сведения см. в разделе [Затраты на программное обеспечение Windows, не включенные в зарезервированные экземпляры](/azure/billing/billing-reserved-instance-windows-software-costs).  

## <a name="azure-reservations-resources"></a>Ресурсы о резервированиях Azure

|**Сведения о**   |**Прочитайте это**    |
|:-----------------------------|:-----------------|
|Обзор резервирований Azure в программе CSP  | [Продажа Microsoft Azure Reserved VM Instances](azure-reservations.md)
|Приобретение резервирований Azure для клиентов в центре партнеров   | [Приобретение резервирований Azure](azure-reservations-buying.md)
|Управление резервированиями Azure в центре партнеров | [Управление резервированиями Azure в центре партнеров](azure-reservations-manage.md)
|Приобретение резервирований Azure на портале Azure | [Предоплата за виртуальные машины с Azure Reserved VM Instances](/azure/virtual-machines/windows/prepay-reserved-vm-instances) в справке Azure |
|Управление резервированиями Azure на портале Azure   | [Управление зарезервированными экземплярами виртуальных машин](/azure/billing/billing-manage-reserved-vm-instance) в справке Azure  |
|Приобретение резервирований Azure с помощью API Центра партнеров | [Приобретение услуги Azure Reserved VM Instances](/partner-center/develop/purchase-azure-reservations) в документации для разработчиков в Центре партнеров   |
|Предоставление клиентам разрешения на приобретение собственных резервирований Azure из подписки, приобретенной для них. | [Предоставление клиентам разрешения на приобретение собственных резервирований Azure](give-customers-permission.md)   |