---
title: Соединитель совместной продажи для Dynamics 365 CRM Partner Center
ms.topic: how-to
ms.date: 03/01/2021
ms.service: partner-dashboard
ms.subservice: partnercenter-csp
description: Синхронизируйте ссылки в центре партнеров с соединителем совместных продаж для Dynamics 365 CRM. Продавцов может совместно продаваться с корпорацией Майкрософт в ваших системах CRM.
author: sroy
ms.author: sroy
ms.localizationpriority: medium
ms.openlocfilehash: 3724b53f527ebe294590c09d7ad77d0dbcfd9c34
ms.sourcegitcommit: 5e9ca304cce4575eed05ca3b17fb77c9711402a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/10/2021
ms.locfileid: "102532081"
---
# <a name="co-sell-connector-for-dynamics-365-crm--overview"></a>Соединитель совместных продаж для Dynamics 365 CRM — обзор

### <a name="appropriate-roles"></a>Соответствующие роли

- Администратор авторов
- Системный администратор или Настройщик системы в CRM

Соединитель совместных продаж в центре партнеров позволяет продавцов совместную продажу с корпорацией Майкрософт в ваших системах CRM. Они не должны быть обучены для использования центра партнеров для управления сделками в совместных продажах. Используйте соединители совместной продажи, чтобы создать новую ссылку для совместной продажи, которая будет использоваться для привлечения к торговому представителю корпорации Майкрософт, получать ссылки от продавца корпорации Майкрософт, принимать или отклонять ссылки, изменять данные сделки, такие как стоимость сделки и дату закрытия. Вы также можете получить обновления от Microsoft продавцов для этих сделок совместной продажи. Вы можете управлять всеми вашими ссылками в выбранном вами CRM, а не в центре партнеров. 

Решение основано на решении Microsoft Power Автоматизируing и использует API-интерфейсы центра партнеров.

## <a name="before-you-install---pre-requisites"></a>Перед установкой предварительных требований

|**Разделы**   |**Сведения**   |**Ссылки**   |
|--------------|--------------------|------|
|Идентификатор Microsoft Partner Network |Требуется допустимый идентификатор MPN|Присоединение к [MPN](https://partner.microsoft.com/)|
|Готовность к совместной продаже|Ваше решение для работы с IP-адресами и службами должно быть готово к совместной продаже.|[Продажа с Майкрософт](https://partner.microsoft.com/membership/sell-with-microsoft)| 
|Учетная запись Центра партнеров|Идентификатор MPN, связанный с клиентом центра партнеров, должен совпадать с ИДЕНТИФИКАТОРом MPN, связанным с решением для совместной продажи. Прежде чем развертывать соединители, убедитесь, что вы видите ссылки на совместные продажи на портале центра партнеров.|[Управляйте своей учетной записью](create-user-accounts-and-set-permissions.md)|
|Роли пользователей Центра партнеров|Сотрудник, который будет устанавливать и использовать соединители, должен быть администратором ссылок.|[Назначение пользователям ролей и разрешений](create-user-accounts-and-set-permissions.md)| 
|Dynamics 365 CRM|Роль пользователя CRM — системный администратор или Настройщик системы|[Назначение ролей в Dynamics 365](/dynamics365/customerengagement/on-premises/customize/privileges-required-customization)|
|Учетная запись потока Power автоматизиру|Создайте новую рабочую среду с базой данных для тестирования, промежуточного хранения и рабочей среды. Если у вас есть рабочая среда с базой данных, ее можно использовать повторно. Пользователь, который планирует установить решение соединителя, должен иметь лицензию Power автоматизировать и доступ к этой среде. Вы можете отслеживать ход выполнения и получать дополнительные сведения об ошибке установки в [Power Автоматизация](https://flow.microsoft.com/) , щелкнув Просмотреть журнал в разделе решения.|[Создание среды или управление ею](/power-platform/admin/create-environment#create-an-environment-with-a-database)|

## <a name="install-partner-center-referrals-synchronization-for-dynamics-365-power-automate-solution"></a>Установка синхронизации ссылок центра партнеров для Dynamics 365 (решение Power Автоматизация)

1. Откройте [Power автоматизиру](https://flow.microsoft.com) и выберите **среды** в правом верхнем углу. На этом шаге будут показаны доступные экземпляры CRM.

2. Выберите нужный экземпляр CRM в раскрывающемся списке в правом верхнем углу.

3. Выберите **решения** на панели навигации слева.

4. Щелкните ссылку **Open AppSource (открыть** ) в верхнем меню.

   :::image type="content" source="images/cosellconnectors/openappsource.png" alt-text="Открыть AppSource":::

5. Найдите **соединители центров партнеров для Dynamics365** во всплывающем окне.  

6. Нажмите кнопку **получить сейчас** и **Продолжайте**.

7. Откроется страница, на которой можно выбрать среду CRM (Dynamics 365) для установки приложения.  Согласиться с условиями.

8. Вы можете отслеживать ход выполнения и получать дополнительные сведения об ошибке установки в Power Автоматизация, щелкнув **Просмотреть журнал** в разделе **решения**.
 

9. После завершения установки вернитесь к [Power автоматизиру](https://flow.microsoft.com) и выберите **решения** в левой области навигации. Обратите внимание, что в списке решений можно найти **ссылку Центр партнеров синхронизация для Dynamics 365** .

10. Выберите **ссылку Центр партнеров синхронизация для Dynamics 365**. Доступны следующие потоки и сущности Power автоматизировать:

    :::image type="content" source="images/cosellconnectors/dynamics-available-crms.png" alt-text="Доступные КРМС":::

## <a name="best-practice-test-before-you-go-live"></a>Рекомендации: Протестируйте перед переходом в динамический

Прежде чем устанавливать, настраивать и настраивать решение Power Автоматизация в рабочей среде, обязательно протестируйте решение на промежуточном экземпляре CRM.

- Установите решение Microsoft Power автоматизируя в промежуточной среде или экземпляре CRM.
- Настройка и настройка решения Microsoft Power автоматизиру в промежуточной среде.
- Протестируйте решение в промежуточном или экземпляре CRM. 
- При успешном выполнении импортируйте в рабочий экземпляр как управляемое решение. 

## <a name="configure-the-solution"></a>Настройка решения

1. После установки решения в экземпляре CRM вернитесь к [Power автоматизиру](https://flow.microsoft.com/).


2. В раскрывающемся списке **среды** в правом верхнем углу выберите экземпляр CRM, в котором было установлено решение Power автоматизиру.

3. Вам потребуется создать подключения, связывающие три учетные записи пользователей:

   - Пользователь центра партнеров с учетными данными администратора ссылок

   - События Центра партнеров

   - Администратор CRM с потоками Power автоматизиру в решении.

      1. В области навигации слева выберите **подключения** и в списке выберите решение "ссылки центра партнеров".

      2. Создайте подключение, щелкнув **создать соединение**.

         :::image type="content" source="images/cosellconnectors/dynamics-1.png" alt-text="Создание подключения":::

      3. Поиск **ссылок центра партнеров (Предварительная версия)** на панели поиска в правом верхнем углу.

      4. Создайте подключение для пользователя центра партнеров с ролью учетных данных администратора ссылок.

      5. Затем создайте подключение к событиям центра партнеров для пользователя центра партнеров с учетными данными администратора ссылок.

      6. Создайте подключение для Common Data Service (текущего окружения) для пользователя администратора CRM.
     
      7. После добавления всех подключений в вашей среде должны отобразиться следующие подключения:

         :::image type="content" source="images/cosellconnectors/dynamics-2.png" alt-text="Соединения":::
   
## <a name="edit-the-connections"></a>Изменение подключений

1. Вернитесь на страницу **решения** и выберите **решение по умолчанию**. Выберите **ссылку на подключение (Предварительная версия)** , щелкнув **все**.

:::image type="content" source="images/connection-reference-video.gif" alt-text="Изменение подключений":::

2. Измените каждое из подключений одним, щелкнув значок с тремя точками. Добавьте соответствующие подключения.

:::image type="content" source="images/cosellconnectors/dynamics-4.png" alt-text="Список подключений"::: 

3.  Вернитесь на страницу решения, выберите Центр партнеров ссылки синхронизация для Dynamics 365 и включите последовательность, щелкнув значок с тремя точками рядом с каждым потоком в следующей последовательности. Если во время включения последовательности возникнут проблемы, см. действия по [настройке](connector-dynamics.md#customize-synchronization-steps) и [действия по устранению неполадок](connectors-troubleshoot.md). 

Включите потоки в следующей последовательности:

- Регистрация веб-перехватчика центра партнеров (Предварительная версия)
- Создание ссылки на совместную продажу — Dynamics 365 в центр партнеров (Предварительная версия)
- Настроен Создание или получение сведений из потока Dynamics 365 
- Центр партнеров по Dynamics 365 — вспомогательная служба (Предварительная версия)
- Центр партнеров обновления справочные продукты Майкрософт для Dynamics 365 (Предварительная версия)
- Центр партнеров по Dynamics 365 (Предварительная версия)
- Dynamics 365 в центр партнеров (Предварительная версия)
- Возможности Dynamics 365 в центре партнеров (Предварительная версия)
- Решения Майкрософт для Dynamics 365 в центре партнеров (Предварительная версия)
 

## <a name="use-webhook-apis-to-register-for-resource-change-events"></a>Использование API веб-перехватчика для регистрации событий изменения ресурсов

Интерфейсы API веб-перехватчиков центра партнеров позволяют регистрироваться для событий изменения ресурсов. Эти события изменения отправляются на URL-адрес в виде HTTP-сообщений.

1. Выберите пункт **Центр партнеров для Dynamics 365 (Предварительная версия)**.

2. Щелкните значок **редактирования** и выберите **время получения HTTP-запроса**.

3. Щелкните значок **копирования** , чтобы скопировать предоставленный URL-адрес HTTP POST.

   :::image type="content" source="images/webhook-video.gif" alt-text="Использование веб-перехватчиков для регистрации изменений ресурсов":::

4. Выберите поток автоматизации Power Center (Предварительная версия) и нажмите кнопку **выполнить**.

5. Убедитесь, что в правой части окна откроется окно "запуск потока", и нажмите кнопку **продолжить**.

6. Введите следующие сведения:

   - **Конечная точка триггера HTTP**: URL-адрес, скопированный с предыдущего шага

   - **Регистрируемые события**: выберите все доступные события ("создаваемые ссылки", "обновление ссылок", "связанная ссылка — создано", "связанная ссылка — Обновлено").

   -**Перезаписать существующие конечные точки триггера (при наличии**). Важно отметить, что для данного события веб-перехватчика можно зарегистрировать только один URL-адрес. Важно отметить, что для данного события веб-перехватчика можно зарегистрировать только один URL-адрес. 

7. Выберите **выполнить** , а затем нажмите кнопку **Готово.**

Теперь веб-перехватчик может прослушивать события создания и обновления.

## <a name="customize-synchronization-steps"></a>Настройка шагов синхронизации

Системы CRM сильно настроены, и вы можете настроить решение Power автоматизируя в соответствии с настройками CRM.  Когда ссылки на совместные продажи синхронизируются между центром партнеров и системой CRM, поля, синхронизированные на ПК центра партнеров, перечислены в разделе [настраиваемое сопоставление полей](https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RWxL6S).

Следуйте руководству по сопоставлению полей. при необходимости внесите соответствующие изменения в **[Настройка] создание или получение сведений из переменных среды или потока Dynamics 365**  . Не рекомендуется обновлять другие потоки в решении Power автоматизиру, так как это может повлиять на будущие обновления решений. 

Ниже приведены доступные настройки.

- Галочка в имени возможности: по умолчанию рядом с именем возможности отображается галочка, чтобы указать, что синхронизация между центром партнеров и Dynamics 365 CRM происходит успешно. Аналогичным образом в случае сбоя синхронизации будет отображаться крестик. Чтобы не допустить добавления проверки или перекрестной маркировки в имени возможности, установите текущее значение флажка отображать в переменной среды имя для возможности значение нет.

- Значение сделки: по умолчанию стоимость сделки из центра партнеров будет синхронизирована с **естиматедвалуе** в CRM и обратно. Если у вас есть другое поле в CRM для синхронизации значения сделки с:

    a.    Измените имя поля значения сделки в переменной среды Dynamics 365 с помощью имени поля CRM. Обратите внимание, что имя поля следует указывать не на его отображаемом имени.

    b.    Изменить **[настроить] Создайте или получите сведения из потока Dynamics 365**  и перейдите к разделу **Создание или обновление** возможной сделки в CRM, а затем обновление **Создайте новую возможность** и **Обновите существующие** действия по возможности, чтобы назначить значение **деалвалуе** для правильного поля в CRM. Также удалите **назначение деалвалуе** из поля **предполагаемый доход** .

- Код страны для учетной записи клиента. при создании новой ссылки обязательно укажите двухбуквенный код страны (ISO 3166). По умолчанию код страны будет синхронизирован с полем address1_country учетной записи в CRM и обратно. Если в CRM есть другое поле для синхронизации кода страны:

   a.    Для поля кода страны без подстановки в учетной записи, которая содержит двухбуквенный код:

   - Обновите имя поля кода страны для учетной записи клиента в переменной среды Dynamics 365 с именем поля CRM. Обратите внимание, что имя поля следует указывать не на его отображаемом имени.

   - Изменить **[настроить] Создайте или получите сведения из потока Dynamics 365**  и перейдите к разделу Создание или получение учетной записи клиента в действии CRM, чтобы назначить значение страны в поле в CRM. Кроме того, удалите назначение значения страны из поля адрес 1: страна или регион.

   b.    Для поля кода страны на основе поиска в учетной записи:

   - Добавьте новое настраиваемое поле в учетную запись и автоматически заполните его на двухбуквенный код страны (ISO 3166) на основе значения, выбранного в поле Поиск, и наоборот.

   - Выполните описанные выше действия для поля Код страны без подстановки, чтобы синхронизировать новое настраиваемое поле из CRM с центром партнеров.

- Поля возможностей. при наличии обязательных полей в возможности, которые необходимо заполнить изменением **[Настройка], создайте или получите сведения из потока Dynamics 365**  и перейдите к разделу **Создание или обновление возможностей** в CRM и измените **действие создать новую возможную сделку** , чтобы назначить значения обязательным полям в соответствии с вашими бизнес-требованиями.

- Поля интересов. Если в интересе есть обязательные поля, которые необходимо заполнить, измените **[customize] создать или получить сведения из потока Dynamics 365**  и перейдите к разделу **Создание или обновление интереса** в CRM и обновите **Создание нового действия интереса** , чтобы назначить значения обязательным полям в соответствии с вашими бизнес-требованиями.

- Учетная запись клиента. когда новая ссылка синхронизируется из центра партнеров в CRM, решение Power автоматизиру пытается выполнить поиск существующей учетной записи в CRM, используя название компании клиента и почтовый индекс. Если он не найден, в CRM будет создана новая учетная запись клиента. Чтобы обновить условия поиска и сведения о создании учетной записи, измените **[Настройка] Создайте или получите сведения из потока Dynamics 365** и перейдите к разделу **Создание или получение учетной записи клиента** в CRM и **Создание действия учетной записи клиента**.

## <a name="update-environment-variable"></a>Обновить переменную среды

Чтобы обновить значение переменной среды, выполните следующие действия.

1. Перейдите на страницу **решения** и выберите **решение по умолчанию**. Выберите **переменную среды** , щелкнув все.

2. Выберите переменную среды для значения, которое требуется обновить, и щелкните значок **изменить** с тремя точками.

3. Обновить **Текущее значение** (не обновлять значение по умолчанию) с помощью параметра " **новое значение** " и указать значение. Значение должно соответствовать типу данных переменной, например, если тип данных да или нет, принимает значение yes или No.

 :::image type="content" source="images/environment-variables-video.gif" alt-text="Обновление переменных среды":::

- Сквозная синхронизация двунаправленной совместной продажи

После установки, настройки и настройки решения Power автоматизиру вы можете протестировать синхронизацию ссылок совместной продажи между Dynamics 365 и центром партнеров.

### <a name="pre-requisites"></a>Предварительные требования

Чтобы синхронизировать ссылки в центре партнеров и Dynamics 365 CRM, решение Power автоматизиру четко обозначает поля ссылок, относящиеся к корпорации Майкрософт. Эта идентификация дает группе продавцов возможность решать, какие ссылки должны предоставляться корпорации Майкрософт для совместной продажи.

Набор настраиваемых полей и объектов будет добавлен как часть установки решения. Пользователь с правами администратора CRM должен создать отдельный раздел CRM с настраиваемыми полями **возможностей** .

Следующие настраиваемые поля должны быть частью раздела CRM:

- **Синхронизация с центром партнеров**: следует ли синхронизировать возможность с центром партнеров Майкрософт. По умолчанию значением этого поля является нет и его необходимо явно задать равным "Да" продавцу, чтобы поделиться возможностью с Майкрософт. Для новых ссылок, предоставленных в центре партнеров в CRM, этому полю будет присвоено значение Да.

- **Идентификатор ссылки**: поле идентификатора только для чтения для ссылки в центре партнеров Майкрософт

- **Ссылка на ссылку: ссылка** только для чтения на ссылку в центре партнеров Майкрософт
- **Как можно получить справку Майкрософт?**: Помогите корпорации Майкрософт получить ссылку. Чтобы создать ссылку на совместную продажу, выберите соответствующую справку в корпорации Майкрософт. Контактное лицо клиента должно быть связано с возможностью создания ссылки для совместной продажи. Чтобы создать ссылку без сопутствующих продаж, оставьте это поле невыбранным. Ссылку на совместную продажу можно преобразовать в ссылку для совместной продажи в любое время, выбрав соответствующий параметр Справка обязательный.

- **Видимость ссылок в центре партнеров Майкрософт**: Выберите видимость в справочной информации центра партнеров Майкрософт. Сделав ее видимой для Microsoft продавцов, вы можете преобразовать ее в совместную продажу. Если требуется справка Майкрософт, по умолчанию ссылка отображается в Microsoft продавцов. Помеченный как видимый, это поле не может быть отменено.

- **Идентификатор Microsoft CRM**. при создании и принятии веб-ссылки на совместную продажу это поле будет заполнено идентификатором Microsoft CRM.

- **Продукты: устарело** — не использовать это поле или добавлять в CRM, оно доступно только для обратной совместимости. Вместо этого используйте решения центра партнеров Майкрософт.

- **Аудит**: журнал аудита только для чтения для синхронизации с ссылками центра партнеров

- **Решения центра партнеров Майкрософт**: Пользовательский объект для связывания готовых решений совместной продажи или решений Майкрософт с возможностью. Одно или несколько решений могут быть добавлены и удалены из возможной сделки. Перед предоставлением доступа к этой возможности в корпорацию Майкрософт обязательно добавьте хотя бы одно решение для совместной продажи или Microsoft. Чтобы связать этот объект с возможной сделкой, обновите форму возможности в CRM:

  Выберите соответствующую вкладку в форме "возможность" и добавьте вложенную сетку, как показано ниже.

  :::image type="content" source="images/cosellconnectors/dynamics-6.png" alt-text="Форма возможности":::

  :::image type="content" source="images/cosellconnectors/dynamics-7.png" alt-text="{alt-text}":::



- После добавления решений Майкрософт вы можете предварительно заполнить сведения о готовых решениях для совместной продажи, чтобы не добавлять их в продавцов. Чтобы добавить новые сведения о решении, перейдите к объекту сведений о решении Майкрософт в CRM и щелкните **Добавить запись** , чтобы добавить одну запись или использовать **отправку Excel** для добавления нескольких записей.

:::image type="content" source="images/dynamic-1a.png" alt-text="Сведения о решении":::

### <a name="scenarios"></a>ВАРИАНТ

1. Синхронизация ссылок при создании или обновлении ссылок в CRM и синхронизации в центре партнеров:

   1. Войдите в среду Dynamics 365 CRM с помощью пользователя, который обладает видимостью в разделе **возможности** CRM.

   2. При создании новой возможности в среде Dynamics 365 убедитесь в наличии раздела Microsoft Partner Center.

   :::image type="content" source="images/dynamic-2a.png" alt-text="Новая возможность"::: 

   3. Чтобы синхронизировать эту возможность с центром партнеров, убедитесь, что в представлении карточка заданы следующие поля:

      - **Как можно получить справку Майкрософт?** чтобы создать ссылку для совместной продажи, выберите соответствующий параметр справки.

         :::image type="content" source="images/dynamic-3a.png" alt-text="Получение соответствующих полей в представлении карточек":::

      - **Контактное лицо клиента**. чтобы создать ссылку на совместную продажу, добавьте Контактное лицо клиента в возможность.
      - **Синхронизация с центром партнеров**: Да

      - Решения Майкрософт. чтобы поделиться ссылкой с корпорацией Майкрософт, добавьте действующее решение для совместной продажи или Microsoft Solution в возможности.
       
      
      :::image type="content" source="images/dynamic-4a.png" alt-text="Идентификатор решения":::

   4. После создания возможности в Dynamics 365 с параметром синхронизация с центром партнеров задайте значение Да, подождите 10 минут и войдите в свою учетную запись центра партнеров. Ваши ссылки будут синхронизированы с Dynamics 365 и идентификатором ссылок. Ссылка на ссылку будет заполнена. В случае сбоя поле аудита будет заполнено информацией об ошибке.
     
    5. Аналогично, для возможности, для которой параметр "Синхронизация с центром партнеров" имеет значение "Да", при обновлении возможности в Dynamics 365 CRM изменения будут синхронизированы в учетной записи центра партнеров.

    6. Возможности, успешно синхронизированные с центром партнеров, будут идентифицированы с помощью значка ✔ в Dynamics 365.

2. Синхронизация ссылок при создании или обновлении ссылок в центре партнеров Майкрософт и синхронизации в среде Dynamics 365:

   1. Войдите на [панель мониторинга](https://partner.microsoft.com/dashboard/home)центра партнеров.

   2. В меню слева выберите **ссылки** .

   3. Создайте новую ссылку для совместной продажи из центра партнеров, выбрав  **новый вариант сделки** .

   4. Войдите в среду Dynamics 365 CRM.

   5. Перейдите к разделу **открытые возможности**. Ссылка, созданная в центре партнеров Майкрософт, теперь синхронизируется в Dynamics 365 CRM.

   6. При выборе синхронизированной ссылки сведения о представлении карточки заполняются.

## <a name="next-steps"></a>Дальнейшие действия

- [Управление потенциальными клиентами](manage-leads.md)

- [Управление возможностями совместной продажи](manage-co-sell-opportunities.md)

- [Дополнительные сведения о платформе Microsoft Power автоматизиру](/power-automate/)

- [Веб-перехватчики Центра партнеров](/partner-center/develop/partner-center-webhooks)
