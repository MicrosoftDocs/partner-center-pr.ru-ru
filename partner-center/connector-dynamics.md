---
title: Соединитель совместной продажи для Dynamics 365 CRM Partner Center
description: Синхронизируйте ссылки в центре партнеров с соединителем совместных продаж для Dynamics 365 CRM. После этого вы можете совместно продавать с корпорацией Майкрософт в вашей системе CRM.
ms.topic: how-to
ms.service: partner-dashboard
ms.subservice: partnercenter-csp
author: sroy
ms.author: sroy
ms.localizationpriority: medium
ms.date: 03/01/2021
ms.openlocfilehash: 2082424f8203f0d9c50726e1e5ef7b3e3c39d6c2
ms.sourcegitcommit: 35fe0fdc41886f6f5af71ec74e4a4ebd245dfe1d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104768777"
---
# <a name="co-sell-connector-for-dynamics-365-crm-overview"></a>Обзор соединителя совместной продажи для Dynamics 365 CRM

### <a name="appropriate-roles"></a>Соответствующие роли

- Администратор авторов
- Системный администратор или Настройщик системы в CRM

Соединители совместной продажи в центре партнеров позволяют продавцов совместно продаваться с корпорацией Майкрософт в ваших системах CRM. Они не должны быть обучены для использования центра партнеров для управления сделками в совместных продажах. Используйте соединители для совместной работы, чтобы создать новую ссылку для совместной продажи, чтобы привлечь продавца Майкрософт, получить ссылки от продавца Майкрософт, принять или отклонить ссылки и изменить данные о сделках, такие как стоимость сделки и Дата закрытия. Вы также можете получить обновления от Microsoft продавцов для этих сделок совместной продажи. Вы можете управлять всеми вашими ссылками в выбранном вами CRM, а не в центре партнеров.

Решение основано на Power автоматизировать и использует API-интерфейсы центра партнеров.

## <a name="prerequisites"></a>Предварительные требования

Перед установкой решения убедитесь в соблюдении следующих предварительных требований.

|**Разделы**   |**Сведения**   |**Ссылки**   |
|--------------|--------------------|------|
|Идентификатор Microsoft Partner Network (MPN) |Требуется допустимый идентификатор MPN.|[Присоединяйтесь к партнерской сети](https://partner.microsoft.com/)|
|Готовность к совместной продаже|Ваше решение для работы с IP-адресами и службами должно быть готово к совместной продаже.|[Продажа с Майкрософт](https://partner.microsoft.com/membership/sell-with-microsoft)|
|Учетная запись Центра партнеров|Идентификатор MPN, связанный с клиентом центра партнеров, должен совпадать с ИДЕНТИФИКАТОРом MPN, связанным с решением для совместной продажи. Прежде чем развертывать соединители, убедитесь, что на портале центра партнеров вы видите ссылки для совместной продажи.|[Управляйте своей учетной записью](create-user-accounts-and-set-permissions.md)|
|Роли пользователей Центра партнеров|Сотрудник, который будет устанавливать и использовать соединители, должен быть администратором ссылок.|[Назначение пользователям ролей и разрешений](create-user-accounts-and-set-permissions.md)|
|Dynamics 365 CRM|Роль пользователя CRM — системный администратор или Настройщик системы.|[Назначение ролей в Dynamics 365](/dynamics365/customerengagement/on-premises/customize/privileges-required-customization)|
|Учетная запись потока Power автоматизиру|Создайте новую рабочую среду с базой данных для тестирования, промежуточного хранения и рабочей среды. Если у вас есть рабочая среда с базой данных, ее можно использовать повторно. Пользователь, который планирует установить решение соединителя, должен иметь лицензию Power автоматизировать и доступ к этой среде. Вы можете отслеживать ход выполнения и получать дополнительные сведения в [Power Автоматизация](https://flow.microsoft.com/) в случае сбоя установки. Выберите **Просмотреть журнал** в разделе **решения**.|[Создание среды или управление ею](/power-platform/admin/create-environment#create-an-environment-with-a-database)|

## <a name="install-partner-center-referrals-synchronization-for-dynamics-365-power-automate-solution"></a>Установка синхронизации ссылок центра партнеров для Dynamics 365 (решение Power Автоматизация)

1. Откройте [Power автоматизиру](https://flow.microsoft.com)и выберите **среды** в правом верхнем углу. На этом шаге будут показаны доступные экземпляры CRM.

1. Выберите нужный экземпляр CRM из раскрывающегося списка в правом верхнем углу.

1. Выберите **решения** слева.

1. Выберите ссылку **Open AppSource (открыть** ) в верхнем меню.

   :::image type="content" source="images/cosellconnectors/openappsource.png" alt-text="Снимок экрана, на котором показано открытое AppSource.":::

1. Найдите **соединители центров партнеров для Dynamics 365** во всплывающем окне.  

1. Нажмите кнопку **получить сейчас** , а затем выберите **продолжить**.

1. Откроется страница, на которой можно выбрать среду CRM (Dynamics 365) для установки приложения. Примите условия.

1. Вы можете отслеживать ход выполнения и, если установка завершается сбоем, вы можете получить дополнительные сведения в Power автоматизируя, выбрав пункт **Просмотреть журнал** в разделе **решения**.

1. После завершения установки вернитесь в [Power автоматизиру](https://flow.microsoft.com) и выберите **Solutions (решения** ) слева. В списке **решений** теперь доступна **Синхронизация ссылок центра партнеров по Dynamics 365** .

1. Выберите **ссылку Центр партнеров синхронизация для Dynamics 365**. Доступны следующие потоки и сущности Power автоматизировать.

    :::image type="content" source="images/cosellconnectors/dynamics-available-crms.png" alt-text="Снимок экрана, на котором показаны доступные Крмс.":::

## <a name="test-before-you-go-live"></a>Протестируйте перед переходом в динамический

Прежде чем устанавливать, настраивать и настраивать решение Power Автоматизация в рабочей среде, обязательно протестируйте решение на промежуточном экземпляре CRM. Вам потребуется:

- Установите решение Power Автоматизируйте в экземпляре CRM промежуточной среды.
- Настройка и настройка решения Power автоматизиру в промежуточной среде.
- Протестируйте решение на промежуточном экземпляре CRM.
- После успешного выполнения теста импортируйте его как управляемое решение в рабочий экземпляр.

## <a name="configure-the-solution"></a>Настройка решения

1. После установки решения в экземпляре CRM вернитесь к [Power автоматизиру](https://flow.microsoft.com/).

1. В раскрывающемся списке **среды** в правом верхнем углу выберите экземпляр CRM, в котором установлено решение Power автоматизировать.

1. Вам потребуется создать подключения, связывающие три учетные записи пользователей:

   - Пользователь центра партнеров с учетными данными администратора ссылок
   - События Центра партнеров
   - Администратор CRM с потоками Power автоматизиру в решении

   1. Выберите **подключения** слева и в списке выберите решение " **ссылки центра партнеров** ".

   1. Создайте подключение, выбрав **создать соединение**.

         :::image type="content" source="images/cosellconnectors/dynamics-1.png" alt-text="Снимок экрана, на котором показано создание соединения.":::

   1. Поиск **ссылок центра партнеров (Предварительная версия)** на панели поиска в правом верхнем углу.

   1. Создайте подключение для пользователя центра партнеров с ролью учетных данных администратора ссылок.

   1. Затем создайте подключение к событиям центра партнеров для пользователя центра партнеров с помощью ссылок на учетные данные администратора.

   1. Создайте подключение для Common Data Service (текущего окружения) для пользователя администратора CRM.
     
   1. После добавления всех подключений в вашей среде должны отобразиться следующие подключения.

      :::image type="content" source="images/cosellconnectors/dynamics-2.png" alt-text="Снимок экрана, на котором показаны соединения.":::

## <a name="edit-the-connections"></a>Изменение подключений

1. Вернитесь на страницу **решения** и выберите **решение по умолчанию**. Выберите **ссылку на подключение (Предварительная версия)** , выбрав **все**.

   :::image type="content" source="images/connection-reference-video.gif" alt-text="Снимок экрана, показывающий изменение подключений.":::

1. Отредактируйте каждое из соединений по одному, щелкнув значок с многоточием. Добавьте соответствующие подключения.

   :::image type="content" source="images/cosellconnectors/dynamics-4.png" alt-text="Снимок экрана, показывающий перечисленные подключения.":::

1.  Вернитесь на страницу **решения** , выберите **Центр партнеров ссылки синхронизация для Dynamics 365** и включите последовательность, щелкнув значок с многоточием рядом с каждым потоком в следующей последовательности. Если во время включения последовательности возникнут проблемы, см. [инструкции по настройке](connector-dynamics.md#customize-synchronization-steps) и действия по [устранению неполадок](connectors-troubleshoot.md).

Включите потоки в следующей последовательности:

- Регистрация веб-перехватчика центра партнеров (Предварительная версия)
- Создание ссылки на совместную продажу — Dynamics 365 в центр партнеров (Предварительная версия)
- Настроен Создание или получение сведений из потока Dynamics 365
- Центр партнеров по Dynamics 365 — вспомогательная служба (Предварительная версия)
- Центр партнеров обновления справочные продукты Майкрософт для Dynamics 365 (Предварительная версия)
- Центр партнеров по Dynamics 365 (Предварительная версия)
- Dynamics 365 в центр партнеров (Предварительная версия)
- Возможности Dynamics 365 в центре партнеров (Предварительная версия)
- Решения Майкрософт для Dynamics 365 в центре партнеров (Предварительная версия)
 
## <a name="use-webhook-apis-to-register-for-resource-change-events"></a>Использование API веб-перехватчика для регистрации событий изменения ресурсов

Для регистрации событий изменения ресурсов можно использовать API-интерфейсы веб-перехватчика центра партнеров. Эти события изменения отправляются на URL-адрес в виде HTTP-сообщений.

1. Выберите пункт **Центр партнеров для Dynamics 365 (Предварительная версия)**.

1. Щелкните значок **изменить** и выберите **время получения HTTP-запроса**.

1. Щелкните значок **копирования** , чтобы скопировать предоставленный URL-адрес HTTP POST.

   :::image type="content" source="images/webhook-video.gif" alt-text="Снимок экрана, показывающий использование веб-перехватчиков для регистрации изменений ресурсов.":::

1. Выберите поток автоматизации Power автоматизированной **регистрации центра партнеров (Предварительная версия)** и нажмите кнопку **выполнить**.

1. Убедитесь, что в области справа откроется окно **Запуск потока** , и выберите **продолжить**.

1. Введите следующие сведения:

   - **Конечная точка триггера HTTP**: этот URL-адрес был скопирован из предыдущего шага.
   - **Регистрируемые события**: выберите все доступные события (**созданные по ссылке**, **обновленные ссылки**, **связанные-ссылки — созданы**, а **связанные ссылки — обновлены**).
   - **Перезаписать существующие конечные точки триггера, если они есть?**: Да. Только один URL-адрес может быть зарегистрирован для конкретного события веб-перехватчика.

1. Выберите **выполнить последовательность** и нажмите кнопку **Готово.**

Веб-перехватчик теперь может ожидать, создавать и обновлять события.

## <a name="customize-synchronization-steps"></a>Настройка шагов синхронизации

Системы CRM сильно настроены, и вы можете настроить решение Power автоматизируя в соответствии с настройками CRM. Когда ссылки на совместные продажи синхронизируются между центром партнеров и системой CRM, поля, синхронизированные на компьютере центра партнеров, перечислены в разделе [настраиваемое сопоставление полей](https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RWxL6S).

Следуйте руководству по сопоставлению полей. при необходимости внесите соответствующие изменения в **[Настройка] создание или получение сведений из переменных среды или потока Dynamics 365** . Не обновляйте другие потоки в решении Power автоматизиру, так как это может повлиять на будущие обновления решений.

Доступны следующие настройки.

- **Отображать флажок в имени возможности**: по умолчанию рядом с именем возможности отображается галочка, чтобы указать, что синхронизация между центром партнеров и Dynamics 365 CRM происходит успешно. Аналогичным образом в случае сбоя синхронизации будет отображаться крестик. Чтобы не допустить добавления флажка или крестика в имени возможности, установите текущее значение **флажка отображение в переменной среды имя возможной сделки** равным нет.
- **Значение сделки**: по умолчанию значение сделки из центра партнеров будет синхронизировано с **естиматедвалуе** в CRM и обратно. Если в CRM есть другое поле для синхронизации значения сделки:

  - Измените имя поля **значения сделки** в переменной среды Dynamics 365 с помощью имени поля CRM. Убедитесь, что вы задаюте имя поля, а не его отображаемое имя.
  - Изменение **[Настройка] создание или получение сведений из потока Dynamics 365**. Перейдите к разделу **Создание или обновление возможностей** в CRM и обновите существующую возможность и обновите существующие действия с **возможностью** **, чтобы** присвоить значение **деалвалуе** правильному полю в CRM. Кроме того, удалите назначение **деалвалуе** из поля **предполагаемый доход** .

- **Код страны для учетной записи клиента**. при создании новой ссылки обязательно укажите двухбуквенный код страны (ISO 3166). По умолчанию код страны будет синхронизирован с полем **address1_country** учетной записи в CRM. Если в CRM есть другое поле для синхронизации кода страны:

   - Для поля неуточняющего кода страны в учетной записи, содержащей двухбуквенный код:
     - Обновите имя поля **кода страны для учетной записи клиента** в переменной среды Dynamics 365 с именем поля CRM. Убедитесь, что вы задаюте имя поля, а не его отображаемое имя.
     - Изменить **[настроить] Создайте или получите сведения из потока Dynamics 365** и перейдите к разделу **Создание или получение учетной записи клиента** в действии CRM, чтобы присвоить значение **Country** правильному полю в CRM. Кроме того, удалите назначение значения **Country** из поля **адрес 1: страна или регион** .

   - Для поля кода страны на основе поиска в учетной записи:
     - Добавьте новое настраиваемое поле в учетную запись и автоматически заполните его двузначным кодом страны (ISO 3166) на основе значения, выбранного в поле поиска, и наоборот.
     - Выполните описанные выше действия для поля Код страны, не являющегося подстановкой, чтобы синхронизировать новое настраиваемое поле из CRM с центром партнеров.

- **Поля возможных сделок**. Если в **возможной возможности** необходимо заполнить обязательные поля, измените **[customize] создание или получение сведений из потока Dynamics 365** и перейдите к разделу **Создание или обновление возможностей** в CRM и обновление **Создание возможной сделки** , чтобы назначить значения обязательным полям в соответствии с вашими бизнес-требованиями.
- **Ведущие поля**. Если в **интересе** есть обязательные поля, которые необходимо заполнить, измените **[customize] создать или получить сведения из потока Dynamics 365** и перейдите к разделу **Создание или обновление интереса** в CRM и обновите страницу Создание **нового интереса** , чтобы назначить значения обязательным полям в соответствии с вашими бизнес-требованиями.
- **Учетная запись клиента**. когда новая ссылка синхронизируется из центра партнеров с CRM, решение Power автоматизиру пытается выполнить поиск существующей учетной записи в CRM, используя название компании клиента и почтовый индекс. Если он не найден, в CRM будет создана новая учетная запись клиента. Чтобы обновить условия поиска и сведения о создании учетной записи, измените **[Настройка] создать или получить сведения из потока Dynamics 365** и перейти к разделу **Создание или получение учетной записи клиента** в CRM и **создать действие учетной записи клиента**.

## <a name="update-environment-variable"></a>Обновить переменную среды

Чтобы обновить значение переменной среды, выполните следующие действия.

1. Перейдите на страницу **решения** и выберите **решение по умолчанию**. Выберите **переменную среды** , выбрав **все**.

1. Выберите переменную среды для значения, которое требуется обновить, и выберите **изменить** с помощью значка многоточия.

1. Обновить **Текущее значение** (не обновлять **значение по умолчанию**) с помощью параметра " **новое значение** " и указав значение. Значение должно соответствовать типу данных переменной. Например, тип данных «да» или «нет» будет принимать значение «Да» или «нет».

   :::image type="content" source="images/environment-variables-video.gif" alt-text="Снимок экрана, на котором показаны переменные среды обновления.":::

## <a name="end-to-end-bidirectional-co-sell-referral-synchronization"></a>Сквозная двунаправленная синхронизация ссылок совместной продаж

После установки, настройки и настройки решения Power автоматизиру вы можете протестировать синхронизацию ссылок совместной продажи между Dynamics 365 и центром партнеров.

### <a name="prerequisites"></a>Предварительные требования

Чтобы синхронизировать ссылки в центре партнеров и Dynamics 365 CRM, решение Power автоматизиру четко обозначает поля ссылок, относящиеся к корпорации Майкрософт. Эта идентификация дает группе продавцов возможность решать, какие ссылки должны предоставляться корпорации Майкрософт для совместной продажи.

Набор настраиваемых полей и объектов будет добавлен как часть установки решения. Пользователь с правами администратора CRM должен создать отдельный раздел CRM с настраиваемыми полями **возможностей** .

Следующие настраиваемые поля должны быть частью раздела CRM:

- **Синхронизация с центром партнеров**: следует ли синхронизировать возможную сделку с центром партнеров. По умолчанию значением этого поля является нет и его необходимо явно задать равным "Да" продавцу, чтобы поделиться возможностью с Майкрософт. Для новых ссылок, предоставленных в центре партнеров в CRM, этому полю будет присвоено значение Да.
- **Идентификатор ссылки**: поле идентификатора только для чтения для ссылки центра партнеров.
- **Ссылка на ссылку: ссылка** только для чтения на ссылку в центре партнеров.
- **Как можно получить справку Майкрософт?**: Помогите корпорации Майкрософт получить ссылку. Чтобы создать ссылку на совместную продажу, выберите необходимую справку Майкрософт. Контактное лицо клиента должно быть связано с возможностью создания ссылки для совместной продажи. Чтобы создать ссылку не на совместную продажу, не выбирайте это поле. Ссылку, не относящуюся к продажам, можно преобразовать в ссылку для совместной продажи в любое время, выбрав соответствующий параметр справки — обязательный вариант.
- **Видимость ссылок в центре партнеров Майкрософт**: Выберите видимость для ссылки центра партнеров. Сделав ее видимой для Microsoft продавцов, вы можете преобразовать ее в совместную продажу. Если требуется справка Майкрософт, ссылка по умолчанию отображается в Microsoft продавцов. После того как это поле будет помечено как видимое, его нельзя будет отменить.
- **Идентификатор Microsoft CRM**. при создании и принятии веб-ссылки на совместную продажу это поле будет заполнено идентификатором Microsoft CRM.
- **Продукты: устарело**. не используйте это поле или добавьте его в раздел CRM. Он доступен только для обратной совместимости. Вместо этого используйте решения центра партнеров.
- **Аудит**: журнал аудита только для чтения для синхронизации с ссылками центра партнеров.
- **Решения центра партнеров Майкрософт**: Пользовательский объект для связывания готовых решений совместной продажи или решений Майкрософт с возможностью. Одно или несколько решений могут быть добавлены или удалены из возможной сделки. Перед предоставлением общего доступа к этой возможности в корпорацию Майкрософт обязательно добавьте по крайней мере одно решение для совместной продажи или решения Майкрософт. Чтобы связать этот объект с возможностью, обновите форму **возможности** в CRM.

  Выберите соответствующую вкладку в форме **возможности** и добавьте вложенную сетку, как показано здесь.

  :::image type="content" source="images/cosellconnectors/dynamics-6.png" alt-text="Снимок экрана, на котором показана форма возможности.":::

  :::image type="content" source="images/cosellconnectors/dynamics-7.png" alt-text="Снимок экрана, на котором показаны решения Майкрософт.":::

- После добавления решений Майкрософт можно предварительно заполнить сведения о готовом решении для совместной продажи, чтобы не добавлять их в продавцов. Чтобы добавить новые сведения о решении, перейдите к объекту сведений о решении Microsoft в CRM и выберите **Добавить запись** , чтобы добавить одну запись, или используйте **отправку Excel** , чтобы добавить несколько записей.

  :::image type="content" source="images/dynamic-1a.png" alt-text="Снимок экрана, показывающий новые сведения о решении Майкрософт.":::

### <a name="scenarios"></a>Сценарии

1. Синхронизация ссылок при создании или обновлении ссылок в CRM и синхронизации в центре партнеров:

   1. Войдите в среду Dynamics 365 CRM с помощью пользователя, который обладает видимостью в разделе **возможности** CRM.

   1. При создании новой возможной сделки в среде Dynamics 365 убедитесь в наличии раздела **Microsoft Partner Center** .

      :::image type="content" source="images/dynamic-2a.png" alt-text="Снимок экрана, показывающий новую возможность.":::

   1. Чтобы синхронизировать эту возможность с центром партнеров, убедитесь, что в представлении карточка заданы следующие поля:

      - **Как можно получить справку Майкрософт?**. чтобы создать ссылку на совместную продажу, выберите соответствующий параметр справки.

         :::image type="content" source="images/dynamic-3a.png" alt-text="Снимок экрана, показывающий, как получить соответствующие поля в представлении карточек.":::

      - **Контактное лицо клиента**. чтобы создать ссылку на совместную продажу, добавьте контактного лица клиента в возможную сделку.
      - **Синхронизация с центром партнеров**: Да.
      - **Решения Майкрософт**. чтобы поделиться ссылкой с корпорацией Майкрософт, добавьте действующее решение для совместной продажи или решения Майкрософт в эту возможность.
      
        :::image type="content" source="images/dynamic-4a.png" alt-text="Снимок экрана, на котором показан идентификатор решения.":::

   1. После создания возможности в Dynamics 365 с параметром **Синхронизация с центром партнеров** задайте значение Да, подождите 10 минут. Затем войдите в свою учетную запись центра партнеров. Ваши ссылки будут синхронизированы с Dynamics 365 и **идентификатором ссылок**. **Ссылка на ссылку** будет заполнена. В случае сбоя поле **аудита** будет заполнено информацией об ошибке.
     
    1. Аналогичным образом, если для параметра **Синхронизация с центром партнеров** установлено значение Да, то при обновлении возможности в Dynamics 365 CRM изменения будут синхронизированы в учетной записи центра партнеров.

    1. Возможности, успешно синхронизированные с центром партнеров, будут идентифицированы с помощью значка ✔ в Dynamics 365.

1. Синхронизация ссылок при создании или обновлении ссылок в центре партнеров и синхронизации в среде Dynamics 365:

   1. Войдите на [панель мониторинга](https://partner.microsoft.com/dashboard/home)центра партнеров.

   1. В меню слева выберите **ссылки** .

   1. Создайте новую ссылку для совместной продажи из центра партнеров, выбрав **новый вариант сделки** .

   1. Войдите в среду Dynamics 365 CRM.

   1. Перейдите к разделу **открытые возможности**. Ссылка, созданная в центре партнеров, теперь синхронизируется в Dynamics 365 CRM.

   1. При выборе синхронизированной ссылки сведения о представлении карточки заполняются.

## <a name="next-steps"></a>Дальнейшие действия

- [Управление потенциальными клиентами](manage-leads.md)
- [Управление возможностями совместной продажи](manage-co-sell-opportunities.md)
- [Дополнительные сведения о платформе Microsoft Power автоматизиру](/power-automate/)
- [Веб-перехватчики Центра партнеров](/partner-center/develop/partner-center-webhooks)
